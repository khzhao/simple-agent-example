## 2048 LoRA PPO Skeleton
- Environment (`src/simple_agent_example/env/game.py`) mirrors the OpenPipe ART 2048 example: deterministic board updates, XML move parsing, and reward shaping toward the 128 tile.
- Rollout loop (`src/simple_agent_example/rollout.py`) now drives the board with an OpenAI teacher (`gpt-4o-mini` by default), scores student replies with the same model, rescales the judge score to `[-1, 1]`, and batches teacher-aligned feedback for PPO.
- OpenAI helpers (`src/simple_agent_example/openai_client.py`) wrap the `openai` SDK to provide teacher rollouts and reward grading that the Qwen policy learns to mimic.
- `TinkerTrainableModel` (`src/simple_agent_example/tinker_client.py`) speaks directly to the official `tinker` SDK: it manages the ServiceClient, sampling client, tokenizer, LoRA forward/backward calls, optimizer steps, and checkpointing.
- Training harness (`src/simple_agent_example/train.py`) gathers concurrent on-policy trajectories, normalizes advantages, proxies them to the Tinker LoRA API, refreshes sampling weights, and repeats.

Install dependencies with `uv sync` (requires `python-dotenv`, `numpy`, `openai`, `tinker`, `torch`). Export both `OPENAI_API_KEY` (for the teacher/reward calls) and `TINKER_API_KEY` (for Qwen LoRA updates), then run `uv run train-2048` (or `python -m simple_agent_example.train`). Optional flags like `--rank`, `--temperature`, `--teacher-openai-model`, or `--reward-openai-model` let you tune sampling/noise. Plug in your ruler/grading callback or additional logging as needed. Use `--wandb-project your_project` (and optionally `--wandb-run-name ...`) to stream rollout statistics to Weights & Biases; add `--no-wandb` to disable logging. If you want to pretrain format compliance, run `uv run sft-2048 --dataset data/sft/2048_sft_dataset.jsonl --save-name 2048-sft-init` to produce a warm-start LoRA checkpoint. To refresh the supervised dataset directly from GPT-4o-mini, run `uv run generate-2048-sft --examples 1000 --output data/sft/gpt4o_generated_2048_sft.jsonl`.
